<?xml version="1.0" encoding="utf-8"?>
<Instance GameID="Morrowind" SortOrder="11">
	<Name Short="Morrowind">The Elder Scrolls III: Morrowind</Name>
	
	<Variables>
		<!--Required-->
		<Entry ID="ActualGameDir" Source="Registry" Type="FSPath" SaveAsOverride="1">
			<Branch>32</Branch>
			<Root>HKEY_LOCAL_MACHINE</Root>
			<Path>SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Steam App 22320</Path>
			<Name>InstallLocation</Name>
			<Type>REG_SZ</Type>
		</Entry>
		<Entry ID="ActualConfigDir">$(ActualGameDir)</Entry>
		<Entry ID="ActualSavesDir">$(ActualGameDir)\Saves</Entry>
		<Entry ID="GameExecutable">Morrowind.exe</Entry>
		<!--<Entry ID="ScriptExtenderID">MWSE</Entry>-->
		<!--<Entry ID="xEditID">tes3</Entry>-->
	</Variables>

	<Network>
		<NetworkManager>
			<NexusID>Morrowind</NexusID>
			<SteamID>22320</SteamID>
		</NetworkManager>
	</Network>

	<Programs>
		<ProgramManager>
			<DefaultPrograms>
				<Entry ShowInMainMenu="1">
					<Name>$(GameShortName)</Name>
					<Executable>Morrowind.exe</Executable>
				</Entry>
				<Entry>
					<Name>$(GameShortName) Launcher</Name>
					<Executable>Morrowind Launcher.exe</Executable>
				</Entry>
				<Entry>
					<Name>Construction Set</Name>
					<Executable>TES Construction Set.exe</Executable>
					<Arguments></Arguments>
				</Entry>
				<Entry>
					<Name>Morrowind Code Patch</Name>
					<Executable>Morrowind Code Patch.exe</Executable>
				</Entry>
				<Entry>
					<Name>Morrowind Graphics Extender XE</Name>
					<Executable>MGEXEGUI.exe</Executable>
				</Entry>
			</DefaultPrograms>
		</ProgramManager>
	</Programs>

	<GameConfig EnableENB="0">
		<Entry ID="0" Format="INI" TypeDetectionMethod="DataAnalysis">$(ConfigDir)\Morrowind.ini</Entry>
	</GameConfig>

	<GameMods>
		<ModManager>
			<MandatoryLocations>
				<Entry Name="$T(ConfigManager.NameShort)">$(ConfigDir)</Entry>
				<Entry Name="$T(SaveManager.NameShort)">$(SavesDir)</Entry>
			</MandatoryLocations>
		</ModManager>
		<TagManager>
			<DefaultTags>
				<Entry ID="Animation">
					<NexusID>51</NexusID>
				</Entry>
				<Entry ID="Armor">
					<NexusID>54</NexusID>
				</Entry>
				<Entry ID="Clothing">
					<NexusID>60</NexusID>
				</Entry>
				<Entry ID="Jewelry">
					<NexusID>102</NexusID>
				</Entry>
				<Entry ID="Weapons">
					<NexusID>55</NexusID>
				</Entry>
				<Entry ID="Gameplay">
					<NexusID>24</NexusID>
				</Entry>
				<Entry ID="Immersion">
					<NexusID>78</NexusID>
				</Entry>
				<Entry ID="Environment">
					<NexusID>74</NexusID>
				</Entry>
				<Entry ID="SkillsAndLeveling">
					<NexusID>73</NexusID>
				</Entry>
				<Entry ID="GuildsAndFactions">
					<NexusID>25</NexusID>
				</Entry>
				<Entry ID="Stealth">
					<NexusID>76</NexusID>
				</Entry>
				<Entry ID="Combat">
					<NexusID>77</NexusID>
				</Entry>
				<Entry ID="Crafting">
					<NexusID>100</NexusID>
				</Entry>
				<Entry ID="Magic">
					<NexusID>75</NexusID>
				</Entry>
				<Entry ID="MagicGameplay">
					<NexusID>93</NexusID>
				</Entry>
				<Entry ID="BooksAndScrolls">
					<NexusID>98</NexusID>
				</Entry>
				<Entry ID="Alchemy">
					<NexusID>94</NexusID>
				</Entry>
				<Entry ID="Quests">
					<NexusID>35</NexusID>
				</Entry>
				<Entry ID="Buildings">
					<NexusID>95</NexusID>
				</Entry>
				<Entry ID="Settlements">
					<NexusID>53</NexusID>
				</Entry>
				<Entry ID="Mercantiles">
					<NexusID>69</NexusID>
				</Entry>
				<Entry ID="New Lands">
					<NexusID>30</NexusID>
				</Entry>
				<Entry ID="Dungeons">
					<NexusID>88</NexusID>
				</Entry>
				<Entry ID="AbandonedStructures">
					<NexusID>70</NexusID>
				</Entry>
				<Entry ID="Player Homes">
					<NexusID>67</NexusID>
				</Entry>
				<Entry ID="Landscape">
					<NexusID>58</NexusID>
				</Entry>
				<Entry ID="Overhauls">
					<NexusID>79</NexusID>
				</Entry>
				<Entry ID="Conversions">
					<NexusID>-1</NexusID>
				</Entry>
				<Entry ID="Audio">
					<NexusID>61</NexusID>
				</Entry>
				<Entry ID="User Interface">
					<NexusID>42</NexusID>
				</Entry>
				<Entry ID="NPC">
					<NexusID>33</NexusID>
				</Entry>
				<Entry ID="Body">
					<NexusID>26</NexusID>
				</Entry>
				<Entry ID="Face">
					<NexusID>26</NexusID>
				</Entry>
				<Entry ID="Hair">
					<NexusID>26</NexusID>
				</Entry>
				<Entry ID="Races">
					<NexusID>34</NexusID>
				</Entry>
				<Entry ID="Followers">
					<NexusID>66</NexusID>
				</Entry>
				<Entry ID="Creatures">
					<NexusID>83</NexusID>
				</Entry>
				<Entry ID="Mounts">
					<NexusID>101</NexusID>
				</Entry>
				<Entry ID="ModelsAndTextures">
					<NexusID>29</NexusID>
				</Entry>
				<Entry ID="Graphics">
					<NexusID>62</NexusID>
				</Entry>
				<Entry ID="ENBPresets">
					<NexusID>97</NexusID>
				</Entry>
				<Entry ID="Collectables">
					<NexusID>92</NexusID>
				</Entry>
				<Entry ID="ItemsAndObjects">
					<NexusID>85</NexusID>
				</Entry>
				<Entry ID="Cheats">
					<NexusID>40</NexusID>
				</Entry>
				<Entry ID="Fixes">
					<NexusID>95</NexusID>
				</Entry>
				<Entry ID="ScriptExtenderPlugins" RequiresScriptExtender="1">
					<NexusID>-1</NexusID>
				</Entry>
				<Entry ID="Utilities">
					<NexusID>39</NexusID>
				</Entry>
				<Entry ID="Configuration">
					<NexusID>116</NexusID>
				</Entry>
				<Entry ID="Resources">
					<NexusID>82</NexusID>
				</Entry>
				<Entry ID="SaveGames">
					<NexusID>43</NexusID>
				</Entry>
				<Entry ID="Misc">
					<NexusID>28</NexusID>
				</Entry>
			</DefaultTags>
		</TagManager>
	</GameMods>

	<GameData>
		<PluginManager Implementation="BethesdaMorrowind" PluginImplementation="BethesdaMorrowind">
			<Limit Value="255"/>

			<ChangeFileModificationDate>1</ChangeFileModificationDate>
			<SortByFileModificationDate>0</SortByFileModificationDate>

			<StandardContent MainID="Morrowind.esm">
				<Entry ID="Morrowind.esm" Name="$(GameShortName)" Logo="Morrowind.png"/>
				<Entry ID="Tribunal.esm" Name="$(GameShortName): Tribunal" Logo="MTB.png"/>
				<Entry ID="Bloodmoon.esm" Name="$(GameShortName): Bloodmoon" Logo="MTB.png"/>
			</StandardContent>
		</PluginManager>

		<SaveManager SaveImplementation="BethesdaMorrowind">
			<Location>$(SavesDir)\Saves</Location>
			<FileFilters>
				<Entry Label="$T(SaveManager.Filter.Saves) (*.ess)">*.ess</Entry>
			</FileFilters>

			<PrimaryExtension>ess</PrimaryExtension>
		</SaveManager>

		<ScreenshotsGallery>
			<Locations>
				<Entry>$(ActualGameDir)</Entry>
				<Entry>$(ActualGameDir)\Screenshots</Entry>
				<Entry>$(OverwritesDir)</Entry>
				<Entry>$(OverwritesDir)\Screenshots</Entry>
			</Locations>
		</ScreenshotsGallery>
	</GameData>

	<Packages>
		<PackageManager>
			<Requirements>
				<!-- General -->
				<Entry ID="Morrowind" Category="$T(PackageManager.ReqCategory.General)">
					<Name>$(GameName)</Name>
					<Object Function="FileExist">Morrowind.exe</Object>
					<Version Function="GTEQ">1.6.0.1820</Version>
				</Entry>
				<Entry ID="$(ScriptExtenderID)" Category="$T(PackageManager.ReqCategory.General)">
					<Name>$(GameShortName) Script Extender</Name>
					<Object Function="FileExist">MWSE.dll</Object>
					<Version Function="GTEQ">0.9.4</Version>
				</Entry>

				<!-- DLC -->
				<Entry ID="DLC-Tribunal" Category="$T(PackageManager.ReqCategory.DLC)">
					<Name>DLC: Tribunal</Name>
					<Object Function="PluginActive">Tribunal.esm</Object>
				</Entry>
				<Entry ID="DLC-Bloodmoon" Category="$T(PackageManager.ReqCategory.DLC)">
					<Name>DLC: Bloodmoon</Name>
					<Object Function="PluginActive">Bloodmoon.esp</Object>
				</Entry>

				<!-- Frameworks -->
				<Entry ID="MCP" Category="$T(PackageManager.ReqCategory.Frameworks)">
					<Name>Morrowind Code Patch</Name>
					<Object Function="FileExist">Morrowind Code Patch.exe</Object>
					<Version Function="GTEQ">2.4</Version>
				</Entry>
				<Entry ID="MGE" Category="$T(PackageManager.ReqCategory.Frameworks)">
					<Name>Morrowind Graphics Extender</Name>
					<Object Function="FileExist">MGEgui.exe</Object>
					<Version Function="GTEQ">3.8</Version>
				</Entry>
				<Entry ID="MGE-XE" Category="$T(PackageManager.ReqCategory.Frameworks)">
					<Name>Morrowind Graphics Extender: XE</Name>
					<Object Function="FileExist">MGEgui.exe</Object>
					<Version Function="GTEQ">0.9</Version>
				</Entry>

				<!-- Body replacers -->
				<Entry ID="BetterBodies" Category="$T(PackageManager.ReqCategory.BodyReplacers)">
					<Name>Better Bodies</Name>
					<Object Function="PluginActive">Better Bodies.esp</Object>
				</Entry>
				<Entry ID="BetterHeads" Category="$T(PackageManager.ReqCategory.BodyReplacers)">
					<Name>Better Heads</Name>
					<Object Function="PluginActive">Better Heads.esp</Object>
				</Entry>

				<!-- Misc -->
				<Entry ID="TR" Category="$T(PackageManager.ReqCategory.Misc)">
					<Name>Tamriel Rebuilt</Name>
					<Object Function="PluginActive">TR_Data.esm</Object>
				</Entry>
				<Entry ID="CH" Category="$T(PackageManager.ReqCategory.Misc)">
					<Name>Chaos Heart</Name>
					<Object Function="PluginActive">ChaosHeart.esp</Object>
				</Entry>
			</Requirements>
		</PackageManager>
	</Packages>
</Instance>
